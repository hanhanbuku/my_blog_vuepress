(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{481:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"一、事件循环"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、事件循环"}},[t._v("#")]),t._v(" 一、事件循环")]),t._v(" "),s("blockquote",[s("p",[t._v("在了解事件循环之前 先要了解什么是同步任务什么是异步任务。我们都知道js代码在执行的时候是按顺序执行，在上一行代码没执行完毕是不能去执行下一行代码的。这也就意味着js在无法同时做多件事情。而异步任务就是为了解决这一问题。")])]),t._v(" "),s("p",[t._v("异步任务又分为宏任务和微任务。而事件循环指的就是宏任务和微任务的执行所产生的一个循环机制。")]),t._v(" "),s("p",[t._v("常见的宏任务有"),s("code",[t._v("script（整体代码）、setTimeout、setInterval、setImmediate（nodejs独有）、requestAnimationFrame（浏览器独有）、IO、UIrender（浏览器独有）")])]),t._v(" "),s("p",[t._v("常见的微任务有："),s("code",[t._v("process.nextTick(nodejs独有)、Promise.then()、Object.observe、MutationObserver")])]),t._v(" "),s("blockquote",[s("p",[t._v("当一段js代码在执行的时候 会维护宏任务和微任务两个队列。遇到了宏任务或者微任务就会将他压入对应的对列中。等当前代码执行完毕后就会将微任务队列里得任务拿出来执行。如果此过程中产生了新的微任务 则又维护一个新的微任务队列，等当前微任务队列清空后再去执行新的微任务队列里得任务，当所有得微任务都执行完之后就会开始执行宏任务队列里得任务。如果此过程中产生了微任务则又会开始执行微任务，以此循环直到两个队列都被清空。这就是事件循环得全过程。ps：微任务会在dom渲染之前执行，因为js引擎线程和GUI线程互斥的原因，导致js在执行，就不会去渲染页面。\n下面让我们看一道练习题来巩固一下知识")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"setTimeout1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"then4"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"then2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"promise1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"then1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"setTimeout2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"then3"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br")])]),s("p",[t._v("首先代码遇到"),s("code",[t._v("setTimeout")]),t._v(" 将他加入宏任务队列，然后执行道第一个"),s("code",[t._v("promise")]),t._v(" 输出其中得同步代码 "),s("code",[t._v("promise1")]),t._v("\n然后将"),s("code",[t._v(".then")]),t._v("加入微任务队列。\n随后又遇到了"),s("code",[t._v("setTimeout")]),t._v(" 将其加入宏任务队列\n紧接着输出"),s("code",[t._v("2")]),t._v("\n最后又是一个"),s("code",[t._v("promise")]),t._v(" 而这个"),s("code",[t._v("promise")]),t._v("里没有同步代码 所以直接将"),s("code",[t._v("then")]),t._v("加入微任务队列。\n此时已经输出了"),s("code",[t._v("promise1，2")]),t._v("。\n而当前得宏任务队列里有两个定时器 微任务队列里有两个"),s("code",[t._v("promise.then")]),t._v("\n现在开始执行微任务，先输出"),s("code",[t._v("then1")]),t._v(" 紧接着输出"),s("code",[t._v("then3")]),t._v(".\n当前微任务队列已经空了 开始执行宏任务队列。\n进入第一个定时器 输出"),s("code",[t._v("setTimeout1")]),t._v("，紧接着又遇到了微任务，所以又开始执行微任务。\n输出"),s("code",[t._v("then2")]),t._v(" 而这个微任务里又有一个微任务 所以接着执行他 输出"),s("code",[t._v("then4")]),t._v("\n微任务清空了 接着去执行宏任务 输出"),s("code",[t._v("setTimeout2")]),t._v(".")]),t._v(" "),s("p",[t._v("所以最终得输出顺序应该是\n"),s("code",[t._v("promise1，2，then1，then3，setTimeout1，then2，then4，setTimeout2")])]),t._v(" "),s("h2",{attrs:{id:"二、作用域-作用域链-执行上下文"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、作用域-作用域链-执行上下文"}},[t._v("#")]),t._v(" 二、作用域，作用域链，执行上下文")]),t._v(" "),s("p",[s("code",[t._v("作用域")]),t._v("指的就是一个变量被定义得区域，他决定了如何查找这个变量以及变量可被访问的权限。\n作用域分为全局作用域 函数作用域 块级作用域。\n在es6之前js是没有块级作用域得 所以除函数作用域外var声明得变量都会提升到全局，变成全局变量。es6引进了let和const两个关键字来声明变量。从而就有了块级作用域的概念 。在一个花括号内使用let和const声明的变量只能在这个块内被访问，外部是无法访问的。const用来声明一个不可改变的常量")]),t._v(" "),s("p",[t._v("js采用的是"),s("code",[t._v("静态作用域")]),t._v("，也就是变量得作用域在他被定义得时候就已经决定了。而与之对应得动态作用域则是在哪儿被调用 作用域就在哪儿。")]),t._v(" "),s("p",[s("code",[t._v("执行上下文")]),t._v("\n当一个函数被调用得时候，js就会进行准备工作， 这个准备工作指的就是"),s("code",[t._v("创建执行上下文")]),t._v("。\n一个执行上下文包括 "),s("code",[t._v("变量对象（vo）")]),t._v(" "),s("code",[t._v("作用域链")]),t._v(" "),s("code",[t._v("this")]),t._v("\n执行上下文也分为全局执行上下文和函数执行上下文。")]),t._v(" "),s("p",[t._v("js有一个专门维护执行上下文得栈 全局执行上下文始终在栈得最底部 每个函数被调用时 他得执行上下文就会被压入栈中 等他执行完毕后 这个执行上下文又会被弹出。")]),t._v(" "),s("p",[t._v("变量对象包括函数得形参 以及函数内部所声明得所有变量。当在函数中访问一个变量时 js会现在当前函数得执行上下文得变量对象中查找，如果没有找到 则会去查找父级作用域得变量对象。一直到全局上下文得变量对象为止。这个查找得过程就是"),s("code",[t._v("作用域链")]),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"三、js垃圾回收机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、js垃圾回收机制"}},[t._v("#")]),t._v(" 三、js垃圾回收机制")]),t._v(" "),s("p",[t._v("js大概有两种垃圾回收机制")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("1、标记清除\njs引擎会给所有的对象打上一个标记，当这个对象被引用时 就会把标记清除掉，最后再把所有还保留这标记的变量回收 释放内存。这种方法会导致有很多内存碎片。")])]),t._v(" "),s("li",[s("p",[t._v("2、引用计数\n采用计数的方式记录一个变量是否可以被回收，初始赋值的时候数值+1当变量被赋值给别人的时候 数量+1 当给变量赋值的时候数量-1，如果变量的计数为0则说明没有人引用这个变量了。则可以回收此变量。直接给变量赋值null此变量就会被回收。")])])]),t._v(" "),s("h2",{attrs:{id:"四、模块化相关"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、模块化相关"}},[t._v("#")]),t._v(" 四、模块化相关")]),t._v(" "),s("blockquote",[s("p",[t._v("模块化有利于代码的提高代码复用性和可维护性，防止命名冲突以及全局污染。")])]),t._v(" "),s("p",[t._v("js的模块化方案大致有以下几种：")]),t._v(" "),s("ul",[s("li",[t._v("1、"),s("code",[t._v("AMD")]),t._v("：异步加载模块，所有的模块代码都写在回调函数中，只有当模块加载完毕才会去执行回调函数里的代码，此模式适用于浏览器端")]),t._v(" "),s("li",[t._v("2、"),s("code",[t._v("CMD")]),t._v("：可异步也可同步的模块加载方案，他和AMD不同的是执行了require就会去加载模块，支持同步也支持异步，支持浏览器也支持node")]),t._v(" "),s("li",[t._v("3、"),s("code",[t._v("UMD")]),t._v("：AMD和CMD的整合")]),t._v(" "),s("li",[t._v("4、"),s("code",[t._v("Commonjs")]),t._v("：这是nodejs的模块化方案他的每个js都是一个模块，每个js中它提供了几个核心变量："),s("code",[t._v("exports、module.exports、require")]),t._v("。前两个用来暴露出变量，最后一个用来引入。")]),t._v(" "),s("li",[t._v("-4.1、require的加载流程：首先被加载的内容分为 node核心模块，自定义模块，文件模块。 像我们通过路劲引入的则是文件模块，而直接通过包名引入的话 commonjs首先会去查找是否是node自带的模块，如果不是则去node_modules里查找这个包，如果还没有则往父级的依赖文件夹里找 直到根目录为止。\n那commonjs是如何避免循环引用和重复加载的呢？\n要搞清楚这个问题得直到module和Module这两个东西，上文说了每个js文件都是一个module，这个module身上不仅有导入导出的方法，还有一个loaded属性，表示这个模块是否被加载过。Module则是nodejs在运行的时候创建的一个保存所有模块值得变量，每个模块在被加载之前都会去Module身上查找是否有缓存，没有的话就会存下。")])]),t._v(" "),s("p",[t._v("有了这两个东西之后commonjs就可以做到避免重复加载和循环引用的问题。")]),t._v(" "),s("ul",[s("li",[t._v("5、ESM："),s("code",[t._v("Es Module")]),t._v("是JS的es6规范才提出的模块化方案，是一个真正属于js自己的模块化规范")])]),t._v(" "),s("p",[t._v("他的诞生有很多优势：\n借助 Es Module 的静态导入导出的优势，实现了 tree shaking。\nEs Module 还可以 import() 懒加载方式实现代码分割。")]),t._v(" "),s("p",[t._v("Es Module 中用 export 用来导出模块，import 用来导入模块。但是 export 配合 import 会有很多种组合情况，接下来我们逐一分析一下。")]),t._v(" "),s("p",[t._v("ESM的导入导出都是静态的，import会自动提升到代码顶部，并且他的语法都不能写在函数作用域和块级作用域内，也不能写在条件判断内。")]),t._v(" "),s("p",[t._v("正因为这种静态的语法，所有他会在代码编译阶段就确定依赖关系，也是借助这个特性，可以做摇树优化。")]),t._v(" "),s("p",[t._v("因为import会提升到最顶部，所以esm的执行顺序是先子后父。")]),t._v(" "),s("p",[t._v("下面总结一下ESM和Commonjs：")]),t._v(" "),s("p",[s("strong",[t._v("Commonjs")]),t._v("：")]),t._v(" "),s("ul",[s("li",[t._v("1、代码运行时加载")]),t._v(" "),s("li",[t._v("2、导出的是值得浅拷贝，值一旦输出，在模块内到处方法是无法修改已导出的值的")]),t._v(" "),s("li",[t._v("3、可以动态加载，对每个导出的值都有缓存，能有效解决循环引用的问题")]),t._v(" "),s("li",[t._v("4、加载的时候才执行")])]),t._v(" "),s("p",[s("strong",[t._v("ESM")])]),t._v(" "),s("ul",[s("li",[t._v("1、代码编译时加载")]),t._v(" "),s("li",[t._v("2、导出的值可以被模块内的方法修改，但不支持外界主动修改")]),t._v(" "),s("li",[t._v("3、写法灵活，可以单个导入导出混合导入导出")]),t._v(" "),s("li",[t._v("4、因为import会提升，所以esm的模块会提前加载并执行")])])])}),[],!1,null,null,null);s.default=e.exports}}]);